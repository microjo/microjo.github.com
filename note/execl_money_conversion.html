<!DOCTYPE HTML>
<html lang="zh">
    <head>
        <meta charset="UTF-8">
        <title>Excel 金额大小写转换公式 | Jonathan's Blog</title>
        <script>if (top !== self) top.location = self.location;</script>
        <!--[if lt IE 9]>
        <script src="/static/html5.js?v=4443b"></script>
        <![endif]-->
        <meta name="HandheldFriendly" content="True" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
        
<meta name="author" content="microjo" />

        
        <link rel="alternate" type="application/rss+xml" href="/feed.html" title="Jonathan's Blog Feed" />
        <link rel="stylesheet" href="/static/style.css?v=47c21" />
        
<link rel="canonical" href="/note/execl_money_conversion.html" />
<link rel="stylesheet" href="/static/syntax.css?v=dbf77" />

        
     </head>
     <body>
         <header id="header">
             <nav class="fn-clear">
                 <ul id="nav" class="fn-right fn-clear">
                     <li id="nav-home"><a href="/">Home/首页</a></li>
                     <li id="nav-about"><a href="/about.html">About/关于</a></li>
                     <li id="nav-tags"><a href="/tag/">Tags/标签</a></li>
                 </ul>
             </nav>
         </header>
         
         <article class="hentry">
             <header class="entry-header fn-clear">
                 <h1 class="entry-title fn-left"><a href="/note/execl_money_conversion.html">Excel 金额大小写转换公式</a></h1>
                 
                 <form id="search-form" action="http://www.google.com/search">
                     <input type="hidden" name="q" value="site:http://microjo.github.com" />
                     <input id="search-input" class="ui-fm-text" type="text" placeholder="Search .." name="q" />
                 </form>
                 
             </header>
             
<div class="entry">
    <div class="entry-content">
        <blockquote>
<ol>
<li>
<p>转自<em>财务经理人 Henry </em>网友，充分利用 Execl 的中文大写转换功能</p>
<pre><code>=IF(ROUND(G8,2)&lt;0,"无效数值",IF(ROUND(G8,2)=0,"零",IF(ROUND(G8,2)&lt;1,"",TEXT(INT(ROUND(G8,2)),"[dbnum2]")&amp;"元")&amp;IF(INT(ROUND(G8,2)*10)-INT(ROUND(G8,2))*10=0,IF(INT(ROUND(G8,2))* (INT(ROUND(G8,2)*100)-INT(ROUND(G8,2)*10)*10)=0,"","零"),TEXT(INT(ROUND(G8,2)*10)-INT(ROUND(G8,2))*10,"[dbnum2]")&amp;"角")&amp;IF((INT(ROUND(G8,2)*100)-INT(ROUND(G8,2)*10)*10)=0,"整",TEXT((INT(ROUND(G8,2)*100)-INT(ROUND(G8,2)*10)*10),"[dbnum2]")&amp;"分")))
</code></pre>
<p>注：“G8”是 Excel 表格中金额小写所在的单元格，各人使用时只需修改下小写所在单元格位置即可。<br />
例1、56137.16 → 伍万陆仟壹佰叁拾柒元壹角陆分<br />
例2、760090.40 → 柒拾陆万零玖拾元肆角整</p>
</li>
<li>
<p><em>shenboo@ExcelHOME</em></p>
<p>附一个我做的人民币大写公式吧，在我的机器上是没有问题的，可是有些机器上就不行。</p>
<pre><code>SUBSTITUTE(IF(TRUNC(单元格)=0,IF(MID(单元格,LEN(TEXT(单元格,"0.00"))-1,1)="0","",TEXT(MID(单元格,LEN(TEXT(单元格,"0.00"))-1,1),"[DBNUM2]") &amp; "角") &amp; IF(RIGHT(TEXT(单元格,"0.00"),1)="0","",TEXT(RIGHT(TEXT(ROUND(单元格,2),"0.00"),1),"[DBNUM2]")&amp;"分"), IF(TRUNC(单元格)=单元格,TEXT(TRUNC(单元格),"[DBNUM2]")&amp;"元",TEXT(TRUNC(单元格)," [DBNUM2]")&amp;"元" &amp; IF(MID(单元格,LEN(TEXT(单元格,"0.00"))-1,1)="0","零",TEXT(MID(单元格,LEN(TEXT(单元格,"0.00"))-1,1),"[DBNUM2]") &amp; "角") &amp; IF(RIGHT(TEXT(单元格,"0.00"),1)="0","",TEXT(RIGHT(TEXT(ROUND(单元格,2),"0.00"),1),"[DBNUM2]")&amp;"分"))),"-","负")
</code></pre>
</li>
</ol>
</blockquote>
<p>上面两个主要使用的 TEXT 函数，这个函数里面重要的就是第二个参数 format_text。“[DBNum2]”的可以把数字转换为中文大写形式。</p>
<h2 id="">相关文章</h2>
<ul>
<li><a href="http://www.ozgrid.com/Excel/CustomFormats.htm">Excel Custom Formats: Numbers/Text Formats in Excel Spreadsheets</a></li>
<li><a href="http://zhidao.baidu.com/question/59085606.html">Excel：关于格式输出[$-409]、[DBNum2]的帮助怎么查找</a></li>
<li><a href="http://huangweidongmei.blog.sohu.com/82608212.html">excel 学习笔记之三（单元格自定义）</a></li>
</ul>
    </div>
    <div class="fn-clear">
        <p class="entry-rel fn-right">
        
        <a id="prev-entry" href="/note/ubuntu_flash_zh.html" title="Ubuntu 8.04/8.10 Flash 中文显示" rel="prev">«Prev</a>
        
        
        <a id="next-entry" href="/note/kvm_compile_audio.html" title="编译 kvm 时选择需要编译的音频驱动" rel="next">Next»</a>
        
        </p>
    </div>
</div>
<div class="entry-meta fn-clear">
    <p class="entry-time fn-left">
    Created at: 
    <a href="/2008/" rel="index"><time class="updated" datetime="2008-12-12T09:48:00Z" pubdate>Fri, Dec 12, 2008</time></a>
    </p>
    
    <p class="entry-tags fn-left">
    Tagged in:
    
    <a href="/tag/excel.html" class="tag" rel="tag">excel</a>
    
    <a href="/tag/text.html" class="tag" rel="tag">TEXT</a>
    
    <a href="/tag/金额大小写转换.html" class="tag" rel="tag">金额大小写转换</a>
    
    </p>
    
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'microjo';
    var disqus_title = 'Excel 金额大小写转换公式';
    (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>


         </article>
         
         <footer id="footer">
             <div class="copyright">© <a href="http://microjo.github.com">Jonathan's Blog</a> | Powered by <a href="http://lepture.com/project/liquidluck">Felix Felicis</a></div>
             <p class="love">Lovely designed by <a href="http://lepture.com">lepture</a> | Modified by MiCRoJo</p>
         </footer>
         <script type="text/javascript">
             var currentNav = window.currentNav || "nav-home";
             document.getElementById(currentNav).className = "current";
         </script>
     </body>
 </html>