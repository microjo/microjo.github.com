<!DOCTYPE HTML>
<html lang="zh">
    <head>
        <meta charset="UTF-8">
        <title>android apktool 升级使用问题一则 | Jonathan's Blog</title>
        <script>if (top !== self) top.location = self.location;</script>
        <!--[if lt IE 9]>
        <script src="/static/html5.js?v=4443b"></script>
        <![endif]-->
        <meta name="HandheldFriendly" content="True" />
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0" />
        
<meta name="author" content="microjo" />

        
        <link rel="alternate" type="application/rss+xml" href="/feed.xml" title="Jonathan's Blog Feed" />
        <link rel="stylesheet" href="/static/style.css?v=47c21" />
        
<link rel="canonical" href="/note/apktool_update_usenote.html" />
<link rel="stylesheet" href="/static/syntax.css?v=dbf77" />

        
     </head>
     <body>
         <header id="header">
             <nav class="fn-clear">
                 <ul id="nav" class="fn-right fn-clear">
                     <li id="nav-home"><a href="/">Home/首页</a></li>
                     <li id="nav-about"><a href="/about.html">About/关于</a></li>
                     <li id="nav-tags"><a href="/tag/">Tags/标签</a></li>
                 </ul>
             </nav>
         </header>
         
         <article class="hentry">
             <header class="entry-header fn-clear">
                 <h1 class="entry-title fn-left"><a href="/note/apktool_update_usenote.html">android apktool 升级使用问题一则</a></h1>
                 
                 <form id="search-form" action="http://www.google.com/search">
                     <input type="hidden" name="q" value="site:http://microjo.github.com" />
                     <input id="search-input" class="ui-fm-text" type="text" placeholder="Search .." name="q" />
                 </form>
                 
             </header>
             
<div class="entry">
    <div class="entry-content">
        <p>最近使用 Dodo APKTools 修改 <code>Zinio.apk</code>，反编译提示成功，修改 xml 文档后，重新编译也提示成功，但是找不到 apk 文件，原因不明。后来使用机锋论上的 apktool GUI 反编译，出现错误信息，反编译失败。日志显示：</p>
<pre><code>I: Loading resource table from file: C:\Users\用户名\apktool\framework\1.apk

Exception in thread "main" brut.androlib.err.UndefinedResObject: resource spec: 0x01030118
    at brut.androlib.res.data.ResPackage.getResSpec(Unknown Source)
    at brut.androlib.res.data.ResTable.getResSpec(Unknown Source)
    at brut.androlib.res.data.ResTable.getResSpec(Unknown Source)
    at brut.androlib.res.data.value.ResReferenceValue.getReferent(Unknown Source)
    at brut.androlib.res.data.value.ResReferenceValue.toResXmlFormat(Unknown Source)
    at brut.androlib.res.data.value.ResStyleValue.serializeToXml(Unknown Source)
    at brut.androlib.res.AndrolibResources.generateValuesFile(Unknown Source)
    at brut.androlib.res.AndrolibResources.decode(Unknown Source)
    at brut.androlib.Androlib.decodeResourcesFull(Unknown Source)
    at brut.androlib.ApkDecoder.decode(Unknown Source)
    at brut.apktool.Main.cmdDecode(Unknown Source)
    at brut.apktool.Main.main(Unknown Source)
</code></pre>
<p>联系 apktool GUI 作者反映了问题，使用新版仍然有这个问题。索性到 <a href="http://code.google.com/p/android-apktool">apktool 官网</a>下载了最新的版本，用命令行反编译，还是出现同样的问题，提示也类似。既然提示使用了一个 resource table 文件，我删除掉让命令行重新生成，再次使用命令行反编译竟然成功。反过来，重新使用 Dodo APKTools 修改 apk 也成功了。说明 apktool 使用过程中释放了一些文件，这些文件不会随着 apktool 的升级而自动重新生成，必须先清除掉旧版本的文件，才能自动产生新版本文件。因此，建议<em>使用 apktool 包括以其为内核的软件，在升级 apktool 时，将系统用户目录 <code>\apktool\framework</code>（以 Win7 举例：<code>C:\Users\用户名\apktool\framework</code>）中的文件清除，保证使用新的文件</em>。</p>
    </div>
    <div class="fn-clear">
        <p class="entry-rel fn-right">
        
        <a id="prev-entry" href="/work/m9firmware.html" title="M9 固件相关信息和工具" rel="prev">«Prev</a>
        
        
        <a id="next-entry" href="/entertainment/humble_frozenbyte_bundle.html" title="跨平台无 DRM 独立游戏软件合集 Humble Frozenbyte Bundle" rel="next">Next»</a>
        
        </p>
    </div>
</div>
<div class="entry-meta fn-clear">
    <p class="entry-time fn-left">
    Created at: 
    <a href="/2011/" rel="index"><time class="updated" datetime="2011-05-18T05:40:00Z" pubdate>Wed, May 18, 2011</time></a>
    </p>
    
    <p class="entry-tags fn-left">
    Tagged in:
    
    <a href="/tag/android/" class="tag" rel="tag">android</a>
    
    <a href="/tag/apktool/" class="tag" rel="tag">apktool</a>
    
    <a href="/tag/gui/" class="tag" rel="tag">gui</a>
    
    </p>
    
</div>


         </article>
         
         <footer id="footer">
             <div class="copyright">© <a href="http://microjo.github.com">Jonathan's Blog</a> | Powered by <a href="http://lepture.com/project/liquidluck">Felix Felicis</a></div>
             <p class="love">Lovely designed by <a href="http://lepture.com">lepture</a> | Modified by MiCRoJo</p>
         </footer>
         <script type="text/javascript">
             var currentNav = window.currentNav || "nav-home";
             document.getElementById(currentNav).className = "current";
         </script>
     </body>
 </html>